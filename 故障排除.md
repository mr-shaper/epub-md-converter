# epub2MD GUI 故障排除指南

## 问题: "转换失败: Failed to fetch"

这个错误通常表示前端无法连接到后端服务器。

### 解决步骤

#### 1. 检查服务器是否正在运行

在终端中运行：
```bash
lsof -i :3737
```

**如果没有输出**，说明服务器未运行，请按照步骤2启动服务器。

**如果有输出**，说明服务器正在运行，请跳到步骤3。

#### 2. 启动服务器

使用以下任一方式启动：

**方式A: 双击启动文件（推荐）**
```
双击 "启动 epub2MD GUI.command"
```

**方式B: 使用终端**
```bash
cd "/Users/mrshaper/Library/CloudStorage/OneDrive-SharedLibraries-onedrive/文档/Obsidian Vault/AI 应用/epub2MD"
./start-gui.sh
```

#### 3. 检查浏览器地址

确保在浏览器中访问的是：
```
http://localhost:3737
```

**注意**: 不要使用 `https://`，只用 `http://`

#### 4. 清除浏览器缓存

如果以上都正常，尝试：
1. 按 `Cmd+Shift+R` 强制刷新页面
2. 或者清除浏览器缓存后重新访问

#### 5. 查看服务器日志

在终端窗口（运行服务器的窗口）中查看是否有错误信息。

### 常见错误汇总

| 错误  | 原因 | 解决方法 |
|------|------|---------|
| Failed to fetch | 服务器未运行 | 启动服务器 |
| Port already in use | 端口被占用 | 关闭其他实例或修改端口 |
| Permission denied | 权限问题 | 检查文件权限 |
| Module not found | 依赖未安装 | 运行 `cd gui && npm install` |

### 端口被占用

如果端口 3737 被占用：

**查找占用进程**:
```bash
lsof -i :3737
```

**终止进程**:
```bash
kill -9 <PID>
```
（将 `<PID>` 替换为实际的进程ID）

或者修改端口号（见高级配置）。

### 高级配置

#### 修改端口号

编辑 `gui/server.js` 文件，修改第13行：
```javascript
const PORT = 3737; // 改为其他端口，如 8080
```

然后在浏览器中访问新端口：`http://localhost:8080`

## 调试检查清单

使用时请逐项检查：

- [ ] 服务器已启动（终端窗口没有关闭）
- [ ] 端口 3737 没有被其他程序占用
- [ ] 浏览器地址正确: `http://localhost:3737`
- [ ] 浏览器没有使用 HTTPS
- [ ] 依赖已正确安装（有 `gui/node_modules` 文件夹）
- [ ] 没有防火墙阻止本地连接

## 仍然无法解决？

### 完全重新安装

```bash
cd "/Users/mrshaper/Library/CloudStorage/OneDrive-SharedLibraries-onedrive/文档/Obsidian Vault/AI 应用/epub2MD/gui"

# 删除旧的依赖
rm -rf node_modules

# 重新安装
npm install

# 启动服务器
cd ..
./start-gui.sh
```

### 查看详细错误

在浏览器中按 `F12` 或 `Cmd+Option+I` 打开开发者工具，查看 Console 标签页的详细错误信息。

---

**提示**: 大多数 "Failed to fetch" 错误都是因为服务器未启动。双击 `启动 epub2MD GUI.command` 文件并保持终端窗口开启即可解决！
